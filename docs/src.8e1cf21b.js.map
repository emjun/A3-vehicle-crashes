{"version":3,"sources":["index.js"],"names":["console","log","d3","version","require","width","height","adj","timeConv","timeParse","dataset","csv","make_graph","slider","document","getElementById","display","data_s","svg","select","append","attr","then","data","slices","columns","slice","map","id","values","d","date","measurement","xScale","scaleLinear","rangeRound","yScale","domain","extent","max","c","yaxis","axisLeft","ticks","length","scale","xaxis","axisBottom","tickFormat","timeFormat","line","x","y","call","text","style","lines","selectAll","enter","datum","value","on","parentNode","transition","delay","duration","legend","oninput","year","remove"],"mappings":"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","file":"src.8e1cf21b.js","sourceRoot":"../src","sourcesContent":["// Code heavily influenced by many d3js tutorials and stack exchange/similar\n// forums for questions online.\n// parts of code was used from \n// https://chartio.com/resources/tutorials/how-to-resize-an-svg-when-the-window-is-resized-in-d3-js/\n// http://datawanderings.com/2019/11/01/tutorial-making-an-interactive-line-chart-in-d3-js-v-5/\n\nconsole.log(d3.version)\n\nrequire(\"/csv/2004_r.csv\");\nrequire(\"/csv/2005_r.csv\");\nrequire(\"/csv/2006_r.csv\");\nrequire(\"/csv/2007_r.csv\");\nrequire(\"/csv/2008_r.csv\");\nrequire(\"/csv/2009_r.csv\");\nrequire(\"/csv/2010_r.csv\");\nrequire(\"/csv/2011_r.csv\");\nrequire(\"/csv/2012_r.csv\");\nrequire(\"/csv/2013_r.csv\");\nrequire(\"/csv/2014_r.csv\");\nrequire(\"/csv/2015_r.csv\");\nrequire(\"/csv/2016_r.csv\");\nrequire(\"/csv/2017_r.csv\");\n\nwidth = 960;\nheight = 500;\nadj = 150;\n\nconst timeConv = d3.timeParse(\"%I:%M%p\");\n\ndataset = d3.csv(require(\"/csv/2017_r.csv\"));\nmake_graph(dataset);\n\nvar slider = document.getElementById('myRange');\nvar display = document.getElementById('outputId');\n\nslider.value = 2017\ndisplay.value = \"Year 2017\"\n\nslider.oninput = function() {\n    display.value = \"Year \" + slider.value\n\n    year = slider.value\n\n    d3.select(\"div#container\").selectAll(\"*\").remove();\n    dataset = d3.csv(require(\"/csv/\" + year + \"_r.csv\"));\n    make_graph(dataset)\n}\n\nfunction make_graph(data_s) {\n\n    svg = d3.select(\"div#container\").append(\"svg\")\n        .attr(\"viewBox\", \"-\" + adj + \" -\"\n              + adj + \" \" + (width + adj *3) + \" \"\n              + (height + adj*3))\n\n    data_s.then(function(data) {\n        var slices = data.columns.slice(1).map(function(id) {\n            return {\n                id: id,\n                values: data.map(function(d){\n                    return {\n                        date: timeConv(d.date),\n                        measurement: +d[id]\n                    };\n                })\n            };\n        });\n       \n    xScale = d3.scaleLinear().rangeRound([0, height, ]);\n    yScale = d3.scaleLinear().rangeRound([height, 0]);\n    xScale.domain(d3.extent(data, function(d){\n        return timeConv(d.date)}));\n\n    yScale.domain([(0), d3.max(slices, function(c) {\n        return d3.max(c.values, function(d) {\n            return d.measurement + 4; });\n            })\n        ]);\n\n    yaxis = d3.axisLeft()\n        .ticks((slices[0].values).length)\n        .scale(yScale);\n   \n    xaxis = d3.axisBottom()\n        .tickFormat(d3.timeFormat('%I %p'))\n        .scale(xScale);\n       \n    line = d3.line()\n        .x(function(d) { return xScale(d.date); })\n        .y(function(d) { return yScale(d.measurement); });\n   \n    svg.append(\"g\")\n        .attr(\"class\", \"axis\")\n        .attr(\"transform\", \"translate(0,\" + height + \")\")\n        .call(xaxis)\n        .append(\"text\")\n        .text(\"Time of Day (Hourly)\")\n        .attr(\"y\", -6)\n        .attr(\"dx\", \".75em\")\n        .attr(\"x\", width / 2)\n        .style(\"text-anchor\", \"end\");\n\n    svg.append(\"g\")\n        .attr(\"class\", \"axis\")\n        .call(yaxis)\n        .append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"dy\", \".75em\")\n        .attr(\"y\", 6)\n        .style(\"text-anchor\", \"end\")\n        .text(\"Persons Involed in Fatal Crashes\");\n   \n    lines = svg.selectAll(\"lines\")\n        .data(slices)\n        .enter()\n        .append(\"g\");\n\n        lines.append(\"path\")\n        .attr(\"class\", \"line\")\n        .attr(\"d\", function(d) { return line(d.values); });\n       \n        lines.append(\"text\")\n        .attr(\"class\",\"series\")\n        .datum(function(d) {\n            return {\n                id: d.id,\n                value: d.values[d.values.length - 1]}; })\n        .attr(\"transform\", function(d) {\n                return \"translate(\" + (xScale(d.value.date) + 0)  \n                + \",\" + (yScale(d.value.measurement) + 5 )+ \")\"; })\n        .attr(\"x\", 5)\n        .text(function(d) { return \"\" + d.id; });\n\n    lines.append(\"path\")\n        .attr(\"class\", \"ghost-line\")\n        .attr(\"d\", function(d) { return line(d.values); });    \n\nsvg.selectAll(\".ghost-line\")\n    .on('mouseover', function() {\n        d3.select(this.parentNode)\n            .select(\".series\")\n            .transition()\n            .delay(\"100\")\n            .duration(\"10\")\n            .style(\"fill\",\"#2b2929\");\n        })\n    .on('mouseout', function() {\n        legend = d3.select(this.parentNode)\n            .select(\".series\")\n            .transition()\n            .delay(\"100\")\n            .duration(\"10\")\n            .style(\"fill\",\"#d2d2d2\");\n    });\n});\n}"]}